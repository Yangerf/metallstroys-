<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>–ü–æ–¥—Å–ª—É—à–∞–Ω–æ –ú–µ—Ç–∞–ª–ª–æ—Å—Ç—Ä–æ–π ‚Äî –ò–≥—Ä–∞</title>
    <style>
        /* –í–°–ï –°–¢–ò–õ–ò –í–°–¢–†–û–ï–ù–´ - –ù–ï–¢ –í–ù–ï–®–ù–ò–• –§–ê–ô–õ–û–í */
        * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
        body {
            background: linear-gradient(135deg,#1a2a6c,#2a5298);
            color: white; min-height:100vh; padding:20px;
        }
        .container { max-width:1000px; margin:0 auto; padding:10px; }
        .header { text-align:center; margin-bottom:20px; padding:20px; background:rgba(0,0,0,0.3); border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.3); }
        .rainbow-text {
            font-size:2rem; font-weight:bold;
            background:linear-gradient(90deg,red,orange,yellow,green,blue,purple);
            background-size:400% 400%; -webkit-background-clip:text; background-clip:text; color:transparent;
            animation:rainbow 3s ease infinite; margin:10px 0;
        }
        .stats-bar { display:flex; justify-content:space-between; background:rgba(255,255,255,0.08); border-radius:10px; padding:15px; margin:15px 0; flex-wrap:wrap; }
        .stat { text-align:center; flex:1; min-width:120px; margin:5px; }
        .stat-value { font-size:1.2rem; font-weight:bold; margin:5px 0; }
        .money { color: gold; }
        .hunger { color: #ff6666; }
        .health { color: #66ff66; }
        .car-display { text-align:center; margin:10px 0; font-size:1.1rem; color:#ffcc00; background:rgba(0,0,0,0.3); padding:10px; border-radius:10px; }
        .click-area { text-align:center; margin:20px 0; }
        .coin {
            width:120px; height:120px; background: radial-gradient(circle at 30% 30%, gold, orange);
            border-radius:50%; margin:0 auto; display:flex; align-items:center; justify-content:center; font-size:2rem;
            color:#996600; cursor:pointer; border:4px solid orange; box-shadow:0 0 20px gold; user-select:none; transition:transform .1s;
        }
        .coin:active { transform:scale(0.95); box-shadow:0 0 30px gold; }
        .tabs { display:flex; background:rgba(0,0,0,0.3); border-radius:10px 10px 0 0; overflow:hidden; flex-wrap:wrap; }
        .tab { flex:1; padding:12px; text-align:center; cursor:pointer; background:rgba(255,255,255,0.08); transition:background .3s; min-width:100px; }
        .tab.active { background:rgba(255,255,255,0.14); font-weight:bold; }
        .tab-content { display:none; background:rgba(255,255,255,0.08); border-radius:0 0 10px 10px; padding:15px; min-height:220px; }
        .tab-content.active { display:block; }
        .shop-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:10px; }
        .shop-item { background:rgba(0,0,0,0.3); border-radius:10px; padding:12px; transition:transform .2s; }
        .shop-item:hover { transform:translateY(-3px); background:rgba(0,0,0,0.38); }
        .shop-item-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
        .shop-item-name { font-weight:bold; font-size:1rem; }
        .shop-item-cost { color:gold; font-weight:bold; }
        .shop-item-description { color:#ccc; font-size:.85rem; margin-bottom:8px; }
        .buy-btn {
            background:linear-gradient(135deg,#4CAF50,#2E7D32); color:white; border:none; padding:8px 12px; border-radius:5px; cursor:pointer; width:100%; transition:background .3s;
        }
        .buy-btn:disabled { background:#666; cursor:not-allowed; }
        .buy-btn:not(:disabled):hover { background:linear-gradient(135deg,#66BB6A,#388E3C); }
        .notification { position:fixed; top:20px; right:20px; background:#333; color:white; padding:10px 15px; border-radius:8px; box-shadow:0 3px 10px rgba(0,0,0,0.3); display:none; z-index:1000; max-width:300px; word-wrap:break-word; }
        .dino-game-container { text-align:center; margin-top:15px; }
        .dino-game { background:#fff; border-radius:8px; overflow:hidden; margin:0 auto; max-width:500px; }
        .dino-canvas { display:block; background:#f7f7f7; width:100%; height:150px; }
        .dino-controls { margin-top:10px; display:flex; justify-content:center; gap:10px; }
        .dino-btn { background:linear-gradient(135deg,#4CAF50,#2E7D32); color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer; }
        .dino-stats { display:flex; justify-content:space-between; margin-top:8px; color:#333; background:rgba(255,255,255,0.9); padding:8px; border-radius:5px; }
        .control-buttons { display:flex; justify-content:center; gap:10px; margin-top:20px; flex-wrap:wrap; }
        .control-btn { background:linear-gradient(135deg,#9C27B0,#6A1B9A); color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer; }
        @keyframes rainbow { 0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%} }
        @media (max-width:600px){
            .rainbow-text { font-size:1.5rem; }
            .stats-bar { flex-direction:column; gap:8px; }
            .shop-grid { grid-template-columns:1fr; }
            .tab { min-width:33%; font-size:.9rem; padding:10px 5px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="rainbow-text">–ü–æ–¥—Å–ª—É—à–∞–Ω–æ –ú–µ—Ç–∞–ª–ª–æ—Å—Ç—Ä–æ–π</div>
            <div class="stats-bar">
                <div class="stat">
                    <div>–ë–∞–ª–∞–Ω—Å</div>
                    <div class="stat-value money" id="money">0 –ú</div>
                </div>
                <div class="stat">
                    <div>–î–æ—Ö–æ–¥</div>
                    <div class="stat-value" id="income">+0 –ú/—Å–µ–∫</div>
                </div>
                <div class="stat">
                    <div>–ì–æ–ª–æ–¥</div>
                    <div class="stat-value hunger" id="hunger">100%</div>
                </div>
                <div class="stat">
                    <div>–ó–¥–æ—Ä–æ–≤—å–µ</div>
                    <div class="stat-value health" id="health">100%</div>
                </div>
            </div>
            <div class="car-display" id="carDisplay">üö≤ –í–µ–ª–æ—Å–∏–ø–µ–¥</div>
        </div>

        <div class="click-area">
            <div class="coin" id="coin">–ú</div>
            <p style="margin-top:8px; color:#ccc; font-size:.9rem;">–ö–ª–∏–∫–∞–π –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞!</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="auto-clicker">–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</div>
            <div class="tab" data-tab="food">–ú–∞–≥–∞–∑–∏–Ω –µ–¥—ã</div>
            <div class="tab" data-tab="garage">–ì–∞—Ä–∞–∂</div>
            <div class="tab" data-tab="business">–ë–∏–∑–Ω–µ—Å—ã</div>
            <div class="tab" data-tab="entertainment">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</div>
        </div>

        <div class="tab-content active" id="auto-clicker-tab">
            <h3 style="text-align:center; margin-bottom:15px; color:gold;">–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</h3>
            <div class="shop-item">
                <div class="shop-item-header">
                    <div class="shop-item-name">ü§ñ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</div>
                    <div class="shop-item-cost" id="autoClickerCost">500 –ú</div>
                </div>
                <div class="shop-item-description">
                    –£—Ä–æ–≤–µ–Ω—å: <span id="autoClickerLevel">0</span> | –î–æ—Ö–æ–¥: +<span id="autoClickerIncome">0</span> –ú/—Å–µ–∫
                </div>
                <button class="buy-btn" id="autoClickerBtn" onclick="buyAutoClicker()">–£–ª—É—á—à–∏—Ç—å</button>
            </div>
        </div>

        <div class="tab-content" id="food-tab">
            <h3 style="text-align:center; margin-bottom:15px; color:gold;">–ú–∞–≥–∞–∑–∏–Ω –µ–¥—ã</h3>
            <div class="shop-grid">
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üçé –Ø–±–ª–æ–∫–æ</div>
                        <div class="shop-item-cost">5 –ú</div>
                    </div>
                    <div class="shop-item-description">+5% –≥–æ–ª–æ–¥–∞</div>
                    <button class="buy-btn" onclick="buyFood('apple')">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">ü•ñ –•–ª–µ–±</div>
                        <div class="shop-item-cost">10 –ú</div>
                    </div>
                    <div class="shop-item-description">+10% –≥–æ–ª–æ–¥–∞</div>
                    <button class="buy-btn" onclick="buyFood('bread')">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üç≤ –°—É–ø</div>
                        <div class="shop-item-cost">25 –ú</div>
                    </div>
                    <div class="shop-item-description">+25% –≥–æ–ª–æ–¥–∞</div>
                    <button class="buy-btn" onclick="buyFood('soup')">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üçñ –®–∞—à–ª—ã–∫</div>
                        <div class="shop-item-cost">40 –ú</div>
                    </div>
                    <div class="shop-item-description">+40% –≥–æ–ª–æ–¥–∞</div>
                    <button class="buy-btn" onclick="buyFood('shashlik')">–ö—É–ø–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <div class="tab-content" id="garage-tab">
            <h3 style="text-align:center; margin-bottom:15px; color:gold;">–ì–∞—Ä–∞–∂</h3>
            <div class="shop-grid">
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üö≤ –í–µ–ª–æ—Å–∏–ø–µ–¥</div>
                        <div class="shop-item-cost">0 –ú</div>
                    </div>
                    <div class="shop-item-description">–ë–∞–∑–æ–≤—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç</div>
                    <button class="buy-btn" onclick="buyCar('bicycle')" id="bicycleBtn">–í—ã–±—Ä–∞–Ω–æ</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üöó –õ–∞–¥–∞ –ì—Ä–∞–Ω—Ç–∞</div>
                        <div class="shop-item-cost">600,000 –ú</div>
                    </div>
                    <div class="shop-item-description">–ù–∞–¥–µ–∂–Ω–∞—è –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è</div>
                    <button class="buy-btn" onclick="buyCar('lada')" id="ladaBtn">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üöô KIA Rio</div>
                        <div class="shop-item-cost">1,200,000 –ú</div>
                    </div>
                    <div class="shop-item-description">–ü–æ–ø—É–ª—è—Ä–Ω–∞—è –∏–Ω–æ–º–∞—Ä–∫–∞</div>
                    <button class="buy-btn" onclick="buyCar('kia')" id="kiaBtn">–ö—É–ø–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <div class="tab-content" id="business-tab">
            <h3 style="text-align:center; margin-bottom:15px; color:gold;">–ë–∏–∑–Ω–µ—Å—ã</h3>
            <div class="shop-grid">
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üè≠ –ê–∫—Ü–∏–∏ –∑–∞–≤–æ–¥–∞</div>
                        <div class="shop-item-cost">10,000 –ú</div>
                    </div>
                    <div class="shop-item-description">+10 –ú/—Å–µ–∫</div>
                    <button class="buy-btn" id="factoryBtn" onclick="buyBusiness('factory')">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üõí –ü—è—Ç—ë—Ä–æ—á–∫–∞</div>
                        <div class="shop-item-cost">50,000 –ú</div>
                    </div>
                    <div class="shop-item-description">+30 –ú/—Å–µ–∫</div>
                    <button class="buy-btn" id="pyaterochkaBtn" onclick="buyBusiness('pyaterochka')">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div class="shop-item-name">üè™ –ú–∞–≥–Ω–∏—Ç</div>
                        <div class="shop-item-cost">80,000 –ú</div>
                    </div>
                    <div class="shop-item-description">+50 –ú/—Å–µ–∫</div>
                    <button class="buy-btn" id="magnetBtn" onclick="buyBusiness('magnet')">–ö—É–ø–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <div class="tab-content" id="entertainment-tab">
            <h3 style="text-align:center; margin-bottom:15px; color:gold;">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</h3>

            <div class="dino-game-container">
                <h4 style="text-align:center; margin-bottom:10px;">ü¶ñ –î–∏–Ω–æ–∑–∞–≤—Ä–∏–∫</h4>
                <div class="dino-game">
                    <canvas id="dinoCanvas" width="500" height="150" class="dino-canvas"></canvas>
                </div>
                <div class="dino-stats">
                    <div>–û—á–∫–∏: <span id="dinoScore">0</span></div>
                    <div>–†–µ–∫–æ—Ä–¥: <span id="dinoHighScore">0</span></div>
                </div>
                <div class="dino-controls">
                    <button class="dino-btn" onclick="startDinoGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button class="dino-btn" onclick="pauseDinoGame()">–ü–∞—É–∑–∞</button>
                </div>
                <p style="margin-top:8px; color:#ccc; font-size:.8rem;">–ü—Ä–æ–±–µ–ª –∏–ª–∏ —Å—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö –¥–ª—è –ø—Ä—ã–∂–∫–∞</p>
            </div>
        </div>

        <div class="control-buttons">
            <button class="control-btn" onclick="saveGame()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button class="control-btn" onclick="loadGame()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            <button class="control-btn" onclick="resetGame()">üîÅ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // --- –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ---
        let money = 0;
        let income = 0;
        let hunger = 100;
        let health = 100;
        let level = 1;
        let autoClickerLevel = 0;
        let autoClickerIncome = 0;
        let currentCar = "bicycle";
        let hungerTimer = 0;

        const cars = {
            bicycle: { name: "üö≤ –í–µ–ª–æ—Å–∏–ø–µ–¥", cost: 0 },
            lada: { name: "üöó –õ–∞–¥–∞ –ì—Ä–∞–Ω—Ç–∞", cost: 600000 },
            kia: { name: "üöô KIA Rio", cost: 1200000 },
            bmw: { name: "üöò BMW X5", cost: 6500000 },
            mercedes: { name: "üèéÔ∏è Mercedes S-Class", cost: 12000000 },
            lambo: { name: "üöÄ Lamborghini", cost: 25000000 }
        };

        const businesses = {
            factory: { cost: 10000, income: 10, bought: false },
            pyaterochka: { cost: 50000, income: 30, bought: false },
            magnet: { cost: 80000, income: 50, bought: false }
        };

        const foods = {
            apple: { cost: 5, effect: 5 },
            bread: { cost: 10, effect: 10 },
            soup: { cost: 25, effect: 25 },
            shashlik: { cost: 40, effect: 40 }
        };

        // --- –î–∏–Ω–æ–∑–∞–≤—Ä–∏–∫ ---
        let dinoGameActive = false;
        let dinoGamePaused = false;
        let dinoScore = 0;
        let dinoHighScore = 0;
        let dinoGameInterval = null;
        let dinoY = 0;
        let dinoJumping = false;
        let dinoVelocity = 0;
        let obstacles = [];

        // --- –≠–ª–µ–º–µ–Ω—Ç—ã ---
        const moneyEl = document.getElementById('money');
        const incomeEl = document.getElementById('income');
        const hungerEl = document.getElementById('hunger');
        const healthEl = document.getElementById('health');
        const coinEl = document.getElementById('coin');
        const notificationEl = document.getElementById('notification');
        const carDisplayEl = document.getElementById('carDisplay');
        const autoClickerLevelEl = document.getElementById('autoClickerLevel');
        const autoClickerIncomeEl = document.getElementById('autoClickerIncome');
        const autoClickerCostEl = document.getElementById('autoClickerCost');
        const autoClickerBtn = document.getElementById('autoClickerBtn');
        const dinoCanvas = document.getElementById('dinoCanvas');
        const dinoScoreEl = document.getElementById('dinoScore');
        const dinoHighScoreEl = document.getElementById('dinoHighScore');

        // --- –í–∫–ª–∞–¥–∫–∏ ---
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                const content = document.getElementById(`${tab.dataset.tab}-tab`);
                if (content) content.classList.add('active');
            });
        });

        // --- –ö–ª–∏–∫ –ø–æ –º–æ–Ω–µ—Ç–µ ---
        coinEl.addEventListener('click', function() {
            money += 1;
            updateDisplay();
            showNotification('+1 –ú', '#ffd54f');
        });

        // --- –§—É–Ω–∫—Ü–∏–∏ –ø–æ–∫—É–ø–∫–∏ –µ–¥—ã ---
        function buyFood(type) {
            const food = foods[type];
            if (!food) return;
            if (money >= food.cost) {
                money -= food.cost;
                hunger = Math.min(100, hunger + food.effect);
                updateDisplay();
                showNotification('–ü–æ–µ–ª! +' + food.effect + '% –≥–æ–ª–æ–¥–∞', '#a5d6a7');
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', '#ef9a9a');
            }
        }

        // --- –ü–æ–∫—É–ø–∫–∞ –±–∏–∑–Ω–µ—Å–∞ ---
        function buyBusiness(type) {
            const business = businesses[type];
            if (!business) return;
            if (business.bought) {
                showNotification('–£–∂–µ –∫—É–ø–ª–µ–Ω–æ!', '#ffb74d');
                return;
            }
            if (money >= business.cost) {
                money -= business.cost;
                income += business.income;
                business.bought = true;
                updateDisplay();
                updateButtons();
                showNotification('–ë–∏–∑–Ω–µ—Å –∫—É–ø–ª–µ–Ω! +' + business.income + ' –ú/—Å–µ–∫', '#81d4fa');
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', '#ef9a9a');
            }
        }

        // --- –ü–æ–∫—É–ø–∫–∞ –º–∞—à–∏–Ω—ã ---
        function buyCar(type) {
            const car = cars[type];
            if (!car) return;
            if (type === 'bicycle') {
                currentCar = 'bicycle';
                updateDisplay();
                updateButtons();
                showNotification('–í—ã–±—Ä–∞–ª–∏ –í–µ–ª–æ—Å–∏–ø–µ–¥', '#ffe082');
                return;
            }
            if (money >= car.cost) {
                money -= car.cost;
                currentCar = type;
                updateDisplay();
                updateButtons();
                showNotification('–ö—É–ø–ª–µ–Ω–∞ ' + car.name + '!', '#ffd54f');
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', '#ef9a9a');
            }
        }

        // --- –£–ª—É—á—à–µ–Ω–∏–µ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ ---
        function buyAutoClicker() {
            if (autoClickerLevel >= 5) {
                showNotification('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å!', '#ffb74d');
                return;
            }
            const cost = 500 * Math.pow(2, autoClickerLevel); // 500, 1000, 2000, 4000, 8000
            if (money >= cost) {
                money -= cost;
                autoClickerLevel++;
                autoClickerIncome = Math.pow(2, autoClickerLevel - 1); // 1,2,4,8,16
                updateDisplay();
                updateButtons();
                showNotification('–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä —É–ª—É—á—à–µ–Ω! –£—Ä–æ–≤–µ–Ω—å ' + autoClickerLevel, '#b39ddb');
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', '#ef9a9a');
            }
        }

        // --- –î–∏–Ω–æ–∑–∞–≤—Ä–∏–∫: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ---
        function startDinoGame() {
            if (dinoGameActive && !dinoGamePaused) return;
            dinoGameActive = true;
            dinoGamePaused = false;
            dinoScore = 0;
            dinoY = 0;
            dinoJumping = false;
            dinoVelocity = 0;
            obstacles = [];
            updateDinoScore();
            drawDinoGame();
            if (dinoGameInterval) clearInterval(dinoGameInterval);
            dinoGameInterval = setInterval(updateDinoGame, 50);
            showNotification('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!', '#a5d6a7');
        }

        function pauseDinoGame() {
            if (!dinoGameActive) return;
            dinoGamePaused = !dinoGamePaused;
            if (dinoGamePaused) {
                if (dinoGameInterval) clearInterval(dinoGameInterval);
                drawDinoGame();
                showNotification('–ò–≥—Ä–∞ –Ω–∞ –ø–∞—É–∑–µ', '#ffb74d');
            } else {
                dinoGameInterval = setInterval(updateDinoGame, 50);
                showNotification('–ò–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è', '#a5d6a7');
            }
        }

        function updateDinoGame() {
            if (!dinoGameActive || dinoGamePaused) return;
            dinoScore++;
            // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è –∏ –ø—Ä—ã–∂–æ–∫
            if (dinoJumping) {
                dinoY += dinoVelocity;
                dinoVelocity += 1;
                if (dinoY >= 0) {
                    dinoY = 0;
                    dinoJumping = false;
                    dinoVelocity = 0;
                }
            }
            // –°–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
            if (Math.random() < 0.05) {
                obstacles.push({ x: dinoCanvas.width, width: 20 + Math.floor(Math.random() * 10), height: 20 + Math.floor(Math.random() * 30) });
            }
            // –î–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            obstacles.forEach(obstacle => { obstacle.x -= 5; });
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã—à–µ–¥—à–∏—Ö –∑–∞ —ç–∫—Ä–∞–Ω
            obstacles = obstacles.filter(obstacle => obstacle.x > -obstacle.width);
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
            obstacles.forEach(obstacle => {
                // dino at x ~ 40..60, y baseline = 0 (ground). dino height 30.
                const dinoLeft = 40;
                const dinoRight = 60;
                const dinoTop = ( -dinoY );
                const dinoBottom = dinoTop + 30;
                const obsLeft = obstacle.x;
                const obsRight = obstacle.x + obstacle.width;
                const obsTop = -obstacle.height;
                const obsBottom = 0;
                // Simplified collision: when obstacle near dino horizontal and dino on ground
                if (obsLeft < dinoRight && obsRight > dinoLeft && dinoY === 0) {
                    // collision
                    dinoGameActive = false;
                    if (dinoGameInterval) clearInterval(dinoGameInterval);
                    showNotification('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –û—á–∫–∏: ' + dinoScore, '#ef9a9a');
                    if (dinoScore > dinoHighScore) {
                        dinoHighScore = dinoScore;
                        updateDinoScore();
                    }
                }
            });
            updateDinoScore();
            drawDinoGame();
        }

        function drawDinoGame() {
            const ctx = dinoCanvas.getContext('2d');
            const width = dinoCanvas.width;
            const height = dinoCanvas.height;
            // –û—á–∏—Å—Ç–∫–∞
            ctx.clearRect(0, 0, width, height);
            // –ó–µ–º–ª—è
            ctx.fillStyle = '#535353';
            ctx.fillRect(0, height - 20, width, 20);
            // –î–∏–Ω–æ–∑–∞–≤—Ä–∏–∫
            ctx.fillStyle = '#535353';
            ctx.fillRect(40, height - 50 - dinoY, 20, 30);
            // –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
            obstacles.forEach(obstacle => {
                ctx.fillStyle = '#2a8c55';
                ctx.fillRect(obstacle.x, height - 20 - obstacle.height, obstacle.width, obstacle.height);
            });
            // –û–±–ª–∞–∫–∞
            ctx.fillStyle = '#f0f0f0';
            ctx.beginPath();
            ctx.arc(200, 50, 15, 0, Math.PI * 2);
            ctx.arc(220, 50, 20, 0, Math.PI * 2);
            ctx.arc(240, 50, 15, 0, Math.PI * 2);
            ctx.fill();
            // –ü–∞—É–∑–∞
            if (dinoGamePaused) {
                ctx.fillStyle = 'rgba(0,0,0,0.6)';
                ctx.fillRect(0, 0, width, height);
                ctx.fillStyle = '#fff';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('–ü–ê–£–ó–ê', width / 2, height / 2);
            }
        }

        function updateDinoScore() {
            dinoScoreEl.textContent = dinoScore;
            dinoHighScoreEl.textContent = dinoHighScore;
        }

        // –ü—Ä—ã–∂–æ–∫ –¥–∏–Ω–æ–∑–∞–≤—Ä–∏–∫–∞
        document.addEventListener('keydown', function(e) {
            if ((e.code === 'Space' || e.key === 'ArrowUp') && dinoGameActive && !dinoGamePaused && !dinoJumping) {
                dinoJumping = true;
                dinoVelocity = -12; // —É–º–µ–Ω—å—à–∏–ª —Å–∏–ª—É –ø—Ä—ã–∂–∫–∞ —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ
                showNotification('–ü—Ä—ã–∂–æ–∫!', '#90caf9');
            }
        });

        // --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è –∏ –∫–Ω–æ–ø–æ–∫ ---
        function updateDisplay() {
            moneyEl.textContent = money.toLocaleString() + ' –ú';
            incomeEl.textContent = '+' + (income + autoClickerIncome) + ' –ú/—Å–µ–∫';
            hungerEl.textContent = hunger + '%';
            healthEl.textContent = health + '%';
            carDisplayEl.textContent = cars[currentCar] ? cars[currentCar].name : currentCar;
            autoClickerLevelEl.textContent = autoClickerLevel;
            autoClickerIncomeEl.textContent = autoClickerIncome;
        }

        function updateButtons() {
            // –ë–∏–∑–Ω–µ—Å—ã
            for (const [key, business] of Object.entries(businesses)) {
                const btn = document.getElementById(key + 'Btn');
                if (!btn) continue;
                if (business.bought) {
                    btn.textContent = '–ö—É–ø–ª–µ–Ω–æ';
                    btn.disabled = true;
                } else {
                    btn.textContent = business.cost.toLocaleString() + ' –ú';
                    btn.disabled = money < business.cost;
                }
            }
            // –ú–∞—à–∏–Ω—ã (–≤ UI –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ bicycle, lada, kia)
            for (const [key, car] of Object.entries(cars)) {
                const btn = document.getElementById(key + 'Btn');
                if (!btn) continue;
                if (currentCar === key) {
                    btn.textContent = '–í—ã–±—Ä–∞–Ω–æ';
                    btn.disabled = true;
                } else {
                    btn.textContent = car.cost.toLocaleString() + ' –ú';
                    btn.disabled = money < car.cost;
                }
            }
            // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
            if (autoClickerLevel < 5) {
                const cost = 500 * Math.pow(2, autoClickerLevel);
                autoClickerCostEl.textContent = cost.toLocaleString() + ' –ú';
                autoClickerBtn.textContent = '–£–ª—É—á—à–∏—Ç—å';
                autoClickerBtn.disabled = money < cost;
            } else {
                autoClickerCostEl.textContent = '–ú–∞–∫—Å. —É—Ä.';
                autoClickerBtn.textContent = '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å';
                autoClickerBtn.disabled = true;
            }
        }

        // --- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ---
        let noteTimeout = null;
        function showNotification(text, color) {
            if (noteTimeout) {
                clearTimeout(noteTimeout);
                noteTimeout = null;
            }
            notificationEl.textContent = text;
            // —Ü–≤–µ—Ç –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∫–∞–∫ hex –∏–ª–∏ rgba
            notificationEl.style.background = color || '#333';
            notificationEl.style.display = 'block';
            noteTimeout = setTimeout(() => {
                notificationEl.style.display = 'none';
            }, 2000);
        }

        // --- –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (—Å–µ–∫—É–Ω–¥–∞) ---
        setInterval(() => {
            // –¥–æ—Ö–æ–¥
            money += income + autoClickerIncome;
            // –≥–æ–ª–æ–¥
            hungerTimer++;
            if (hungerTimer >= 10) {
                hunger = Math.max(0, hunger - 1);
                hungerTimer = 0;
            }
            // –µ—Å–ª–∏ –≥–æ–ª–æ–¥ 0 ‚Äî –∑–¥–æ—Ä–æ–≤—å–µ –ø–∞–¥–∞–µ—Ç
            if (hunger === 0) {
                health = Math.max(0, health - 2);
                if (health === 0) {
                    // –µ—Å–ª–∏ –Ω–µ—Ç –¥–µ–Ω–µ–≥ ‚Äî –ø–æ—Ç–µ—Ä—è –ø–æ–ª–æ–≤–∏–Ω—ã
                    if (money >= 1000) {
                        money -= 1000;
                        showNotification('–õ–µ—á–µ–Ω–∏–µ —Å—Ç–æ–∏–ª–æ 1000 –ú!', '#ffcc80');
                    } else {
                        money = Math.floor(money / 2);
                        showNotification('–ü–æ—Ç–µ—Ä—è–ª–∏ –ø–æ–ª–æ–≤–∏–Ω—É –¥–µ–Ω–µ–≥!', '#ef9a9a');
                    }
                    health = 100;
                    hunger = 50;
                }
            }
            updateDisplay();
            updateButtons();
        }, 1000);

        // --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–ó–∞–≥—Ä—É–∑–∫–∞ ---
        function saveGame() {
            try {
                const saveData = {
                    money: money,
                    income: income,
                    hunger: hunger,
                    health: health,
                    autoClickerLevel: autoClickerLevel,
                    autoClickerIncome: autoClickerIncome,
                    currentCar: currentCar,
                    dinoHighScore: dinoHighScore,
                    businesses: businesses
                };
                localStorage.setItem('metallostroySave', JSON.stringify(saveData));
                showNotification('–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!', '#a5d6a7');
            } catch (e) {
                console.error('Save error', e);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!', '#ef9a9a');
            }
        }

        function loadGame() {
            try {
                const saved = localStorage.getItem('metallostroySave');
                if (!saved) {
                    showNotification('–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –∏–≥—Ä—ã', '#ffb74d');
                    return;
                }
                const data = JSON.parse(saved);
                money = typeof data.money === 'number' ? data.money : 0;
                income = typeof data.income === 'number' ? data.income : 0;
                hunger = typeof data.hunger === 'number' ? data.hunger : 100;
                health = typeof data.health === 'number' ? data.health : 100;
                autoClickerLevel = typeof data.autoClickerLevel === 'number' ? data.autoClickerLevel : 0;
                autoClickerIncome = typeof data.autoClickerIncome === 'number' ? data.autoClickerIncome : (autoClickerLevel > 0 ? Math.pow(2, autoClickerLevel - 1) : 0);
                currentCar = data.currentCar || "bicycle";
                dinoHighScore = data.dinoHighScore || 0;
                // –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫—É–ø–ª–µ–Ω–Ω—ã–µ –±–∏–∑–Ω–µ—Å—ã (–±–µ–∑ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã)
                if (data.businesses && typeof data.businesses === 'object') {
                    for (const key of Object.keys(businesses)) {
                        if (data.businesses[key] && typeof data.businesses[key].bought !== 'undefined') {
                            businesses[key].bought = !!data.businesses[key].bought;
                        } else {
                            businesses[key].bought = false;
                        }
                    }
                }
                // –æ–±–Ω–æ–≤–∏–º income, —Ç.–∫. –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º—ã –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –¥–æ—Ö–æ–¥ –æ—Ç –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –±–∏–∑–Ω–µ—Å–æ–≤
                income = 0;
                for (const [k, b] of Object.entries(businesses)) {
                    if (b.bought) income += b.income;
                }
                updateDisplay();
                updateButtons();
                updateDinoScore();
                showNotification('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!', '#a5d6a7');
            } catch (e) {
                console.error('Load error', e);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏!', '#ef9a9a');
            }
        }

        function resetGame() {
            if (!confirm('–ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É? –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω!')) return;
            money = 0;
            income = 0;
            hunger = 100;
            health = 100;
            autoClickerLevel = 0;
            autoClickerIncome = 0;
            currentCar = "bicycle";
            dinoHighScore = 0;
            for (const key in businesses) {
                if (businesses.hasOwnProperty(key)) businesses[key].bought = false;
            }
            updateDisplay();
            updateButtons();
            updateDinoScore();
            showNotification('–ù–æ–≤–∞—è –∏–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞!', '#ffd54f');
            try {
                localStorage.removeItem('metallostroySave');
            } catch (e) { /* ignore */ }
        }

        // --- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ ---
        setInterval(() => {
            try {
                const saveData = {
                    money: money,
                    income: income,
                    hunger: hunger,
                    health: health,
                    autoClickerLevel: autoClickerLevel,
                    autoClickerIncome: autoClickerIncome,
                    currentCar: currentCar,
                    dinoHighScore: dinoHighScore,
                    businesses: businesses
                };
                localStorage.setItem('metallostroySave', JSON.stringify(saveData));
            } catch (e) {
                console.error('Autosave error', e);
            }
        }, 10000);

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI ---
        function init() {
            updateDisplay();
            updateButtons();
            drawDinoGame();
            // –ø–æ–ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–æ–º (–µ—Å–ª–∏ –µ—Å—Ç—å)
            try {
                const saved = localStorage.getItem('metallostroySave');
                if (saved) {
                    // –≤—ã–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É, –Ω–æ –±–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å
                    const data = JSON.parse(saved);
                    money = typeof data.money === 'number' ? data.money : 0;
                    income = 0;
                    if (data.businesses && typeof data.businesses === 'object') {
                        for (const key of Object.keys(businesses)) {
                            if (data.businesses[key] && typeof data.businesses[key].bought !== 'undefined') {
                                businesses[key].bought = !!data.businesses[key].bought;
                            } else {
                                businesses[key].bought = false;
                            }
                        }
                    }
                    for (const [k, b] of Object.entries(businesses)) {
                        if (b.bought) income += b.income;
                    }
                    autoClickerLevel = typeof data.autoClickerLevel === 'number' ? data.autoClickerLevel : 0;
                    autoClickerIncome = typeof data.autoClickerIncome === 'number' ? data.autoClickerIncome : (autoClickerLevel > 0 ? Math.pow(2, autoClickerLevel - 1) : 0);
                    hunger = typeof data.hunger === 'number' ? data.hunger : 100;
                    health = typeof data.health === 'number' ? data.health : 100;
                    currentCar = data.currentCar || 'bicycle';
                    dinoHighScore = data.dinoHighScore || 0;
                }
            } catch (e) {
                console.error('Init load error', e);
            }
            updateDisplay();
            updateButtons();
            updateDinoScore();
        }

        // –ó–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        init();

    </script>
</body>
</html>